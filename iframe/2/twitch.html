<!DOCTYPE html>
<title>Redirect to Twitch</title>
<link rel="preconnect" crossorigin="" href="//p.twitchcdn.net">
<link rel="preconnect" crossorigin="" href="//static.twitchcdn.net">
<script>
onmessage = (e) =>
{
	if (e.source !== parent)
	{
		return;
	}

	let m,
		regexp = /(\w+)=([-\w]+)/g,
		url    = 'https://',
		vars   = {'autoplay': 'false'};
	while (m = regexp.exec(location.hash))
	{
		vars[m[1]] = m[2];
	}

	if (vars['clip_id'])
	{
		url += 'clips.twitch.tv/embed?clip=' + vars['clip_id'];
	}
	else
	{
		url += 'player.twitch.tv/?' + (vars['video_id'] ? 'video=v' + vars['video_id'] : 'channel=' + vars['channel']);
		if (vars['t'])
		{
			url += '&time=' + vars['t'];
		}
	}
	url += '&autoplay=' + vars['autoplay'] + '&parent=' + e.origin.replace(/.*\/|:.*/g, '');

	location.replace(url);
};
</script>