<!DOCTYPE html>
<title>Content from Facebook</title>
<link rel="preconnect" crossorigin="" href="//www.facebook.com">
<!-- Sometimes Facebook tries to resize to 1000px then 552px if it fails -->
<style>iframe{width:100vw !important}.fb-login:not(.fbc-has-badge){display:none}</style>
<body style="margin:0">
<script>
((document, hash, window) =>
{
	// This should handle all three: #123, #p123, and #pfbidXXX
	const [type, id] = ((m) =>
	{
		if (m)
		{
			return [/p/.test(hash) ? 'post' : 'video', m[1]];
		}

		return ['post', hash.replace(/\W/g, '')];
	})(/^#[pv](\d+)$/.exec(hash));

	const body = document.body,
	      path = (type === 'post') ? 'user/' : 'v/',
	      lang = (window.navigator || {}).language || 'enUS';

	body.innerHTML = '<div data-href=//www.facebook.com/' + path + type + 's/' + id + ' class=fb-' + type + '>Cannot load Facebook SDK. Disable any adblocker or tracking protection and try again.</div><p><span class=fb-login>Allow this page in Facebook Container &nbsp; &nbsp; </span>';

	let height, port;
	window.addEventListener(
		'message',
		(e) =>
		{
			let m;
			if (m = /type=resize.*height=(\d+)/.exec(e.data))
			{
				height = +m[1];
			}
			else if (e.data === 's9e:init' && !port)
			{
				port = e.ports[0];
			}
			else if (e.data === 'allowTriggered')
			{
				// Facebook Container's Allow button was pressed
				window.location.reload();
			}

			if (port && height)
			{
				port.postMessage(height);
			}
		},
		{ 'capture': true }
	);

	window.onload = () =>
	{
		const script = document.createElement('script');
		script.src = '//connect.facebook.net/' + lang.substring(0, 2) + '_' + lang.toUpperCase().substring(lang.length - 2) + '/sdk.js#xfbml=1&version=v14.0';
		body.appendChild(script);
	};
})(document, location.hash, window);
</script>